@* SwiftGridColumn - 컬럼 정의 컴포넌트 *@

@using global::SwiftGrid.Entities
@typeparam TItem

@code {
    #region Parameters

    /// <summary>부모 SwiftGrid 컴포넌트 참조 (자동 설정)</summary>
    [CascadingParameter]
    public SwiftGrid<TItem> Owner { get; set; } = default!;

    /// <summary>컬럼에 바인딩할 데이터 필드명 (필수)</summary>
    [Parameter]
    [EditorRequired]
    public string Field { get; set; } = default!;

    /// <summary>컬럼 헤더에 표시할 제목 (필수)</summary>
    [Parameter]
    [EditorRequired]
    public string Title { get; set; } = default!;

    /// <summary>정렬 가능 여부</summary>
    [Parameter]
    public bool Sortable { get; set; } = false;

    /// <summary>컬럼 표시 여부</summary>
    [Parameter]
    public bool Visible { get; set; } = true;

    /// <summary>데이터 포맷터 (Tabulator 포맷터 이름)</summary>
    [Parameter]
    public string? Formatter { get; set; }

    /// <summary>컬럼 너비 (픽셀 단위)</summary>
    [Parameter]
    public int? Width { get; set; }

    /// <summary>헤더 필터 활성화 여부 (true, "input", "number", "select" 등)</summary>
    [Parameter]
    public object? HeaderFilter { get; set; }

    /// <summary>헤더 필터 placeholder 텍스트</summary>
    [Parameter]
    public string? HeaderFilterPlaceholder { get; set; }

    /// <summary>헤더 필터 파라미터 (select 타입의 경우 values 등)</summary>
    [Parameter]
    public object? HeaderFilterParams { get; set; }

    /// <summary>셀 편집 가능 여부 (null이면 SwiftGridOptions 기본값 사용)</summary>
    [Parameter]
    public bool? Editable { get; set; }

    /// <summary>셀 편집기 타입 ("input", "textarea", "number", "select", "date" 등)</summary>
    [Parameter]
    public string? Editor { get; set; }

    /// <summary>셀 편집기 파라미터 (select 타입의 경우 values 등)</summary>
    [Parameter]
    public object? EditorParams { get; set; }

    #endregion

    #region Lifecycle Methods

    protected override void OnInitialized()
    {
        if (Owner == null)
        {
            throw new InvalidOperationException(
                $"{nameof(SwiftGridColumn<TItem>)} must be used inside a {nameof(SwiftGrid<TItem>)}. " +
                $"Wrap the column definitions in a {nameof(SwiftGrid<TItem>)} component.");
        }

        var columnDefinition = new SwiftGridColumnDefinition
        {
            Field = Field,
            Title = Title,
            Sortable = Sortable,
            Visible = Visible,
            Formatter = Formatter,
            Width = Width,
            HeaderFilter = HeaderFilter,
            HeaderFilterPlaceholder = HeaderFilterPlaceholder,
            HeaderFilterParams = HeaderFilterParams,
            Editable = Editable,
            Editor = Editor,
            EditorParams = EditorParams
        };

        Owner.RegisterColumn(columnDefinition);
    }

    #endregion
}
